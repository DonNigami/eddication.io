# Video Generation Settings Enhancement üé¨‚è±Ô∏è

## ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á

‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏¥‡∏õ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô error ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

---

## ‚ú® Features ‡πÉ‡∏´‡∏°‡πà

### 1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (Video Duration)
- **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏î‡πâ:** 5, 10, 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- **‡∏Ñ‡πà‡∏≤ Default:** 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö Runway Gen-3 Alpha Turbo
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô Video Mode

### 2. Delay ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û (Image Generation Delay)
- **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏î‡πâ:** 30, 45, 60, 90, 120 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- **‡∏Ñ‡πà‡∏≤ Default:** 60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô error ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ

### 3. Delay ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (Video Generation Delay)
- **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏î‡πâ:** 60, 90, 120, 150, 180, 240 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- **‡∏Ñ‡πà‡∏≤ Default:** 90 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (1.5 ‡∏ô‡∏≤‡∏ó‡∏µ)
- ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ render ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
- ‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å‡∏à‡∏≤‡∏Å Download Delay

### 4. Delay ‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î (Download Delay)
- **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏î‡πâ:** 0, 5, 10, 15, 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- **‡∏Ñ‡πà‡∏≤ Default:** 0 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)
- Delay ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ render ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
- ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏ì‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

---

## üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. **sidebar.html**
‡πÄ‡∏û‡∏¥‡πà‡∏° UI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Settings Modal:
```html
<select id="videoDuration">
  <option value="5">5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
  <option value="10" selected>10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
  <option value="15">15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
</select>

<select id="imageGenerationDelay">
  <option value="30">30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
  <option value="60" selected>60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
  <option value="90">90 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
  ...
</select>

<select id="videoGenerationDelay">
  <option value="90" selected>90 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
  <option value="120">120 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
  ...
</select>
```

### 2. **js/modules/settings.js**
‡πÄ‡∏û‡∏¥‡πà‡∏° properties ‡πÅ‡∏•‡∏∞ methods:

**Properties:**
- `videoDurationSelect` - Element reference
- `imageGenerationDelaySelect` - Element reference
- `videoGenerationDelaySelect` - Element reference
- `videoDuration` - ‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (default: 10)
- `imageGenerationDelay` - ‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (default: 60)
- `videoGenerationDelay` - ‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (default: 90)
- `downloadDelay` - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô default ‡πÄ‡∏õ‡πá‡∏ô 0

**Methods:**
```javascript
getVideoDuration() ‚Üí number
getImageGenerationDelay() ‚Üí number
getVideoGenerationDelay() ‚Üí number
getDownloadDelay() ‚Üí number (existing, updated)
```

**Storage:**
Settings ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô `chrome.storage.local` ‡∏û‡∏£‡πâ‡∏≠‡∏° sync ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

### 3. **js/sidebar.js**
‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó automation workflow:

**Step 4 - Create Image:**
```javascript
// Before:
await Controls.handleCreate();
await this.delay(60000); // Hardcoded 60s

// After:
await Controls.handleCreate();
const imageDelay = (Settings.getImageGenerationDelay() || 60) * 1000;
this.updateStoryAutomationStatus(`‡∏£‡∏≠‡∏†‡∏≤‡∏û ${Settings.getImageGenerationDelay()} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ...`);
await this.delay(imageDelay);
```

**Step 9 - Create Video:**
```javascript
// Before:
await Controls.handleCreate();
const downloadDelay = (Settings.getDownloadDelay() || 90) * 1000;
await this.delay(downloadDelay);

// After:
await Controls.handleCreate();

// Video generation delay
const videoDelay = (Settings.getVideoGenerationDelay() || 90) * 1000;
this.updateStoryAutomationStatus(`‡∏£‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ ${Settings.getVideoGenerationDelay()} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ...`);
await this.delay(videoDelay);

// Additional download delay (if set)
const downloadDelay = (Settings.getDownloadDelay() || 0) * 1000;
if (downloadDelay > 0) {
  this.updateStoryAutomationStatus(`‡∏£‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ${Settings.getDownloadDelay()} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ...`);
  await this.delay(downloadDelay);
}
```

### 4. **js/modules/controls.js**
‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `setVideoDuration()`:

```javascript
async setVideoDuration() {
  const duration = Settings.getVideoDuration() || 10;
  
  // Click Gen5Duration dropdown
  // Select matching duration option (5s, 10s, 15s)
  // Uses WASM selectors: Gen5DurationBtn, Gen5DurationMenuItem
}
```

‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó `handleVideoMode()`:
```javascript
// After switching to video mode, automatically set duration
if (results && results[0] && results[0].result) {
  await new Promise(resolve => setTimeout(resolve, 1000));
  await this.setVideoDuration(); // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
  
  Helpers.showToast('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô Frames to Video ‡πÅ‡∏•‡πâ‡∏ß', 'success');
}
```

---

## üéØ Use Cases

### Use Case 1: Fast Mode (‡∏£‡∏≠‡∏ô‡πâ‡∏≠‡∏¢)
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏£‡πá‡∏ß ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ô‡πá‡∏ï‡πÄ‡∏£‡πá‡∏ß:
```
Video Duration: 5s
Image Delay: 30s
Video Delay: 60s
Download Delay: 0s
```

### Use Case 2: Balanced (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:
```
Video Duration: 10s (default)
Image Delay: 60s (default)
Video Delay: 90s (default)
Download Delay: 0s (default)
```

### Use Case 3: Safe Mode (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô error)
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ä‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ô‡πá‡∏ï‡∏ä‡πâ‡∏≤:
```
Video Duration: 10s
Image Delay: 90s
Video Delay: 150s
Download Delay: 10s
```

### Use Case 4: Long Videos
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡∏¢‡∏≤‡∏ß 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ:
```
Video Duration: 15s
Image Delay: 60s
Video Delay: 180s (3 ‡∏ô‡∏≤‡∏ó‡∏µ)
Download Delay: 15s
```

---

## üîß Technical Details

### Automation Workflow Timeline

**‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```
Step 4: Create Image ‚Üí Wait 60s (hardcoded)
Step 9: Create Video ‚Üí Wait 90s (downloadDelay)
```

**‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```
Step 4: Create Image ‚Üí Wait [imageGenerationDelay]s (configurable)
Step 9: Create Video ‚Üí Wait [videoGenerationDelay]s + [downloadDelay]s (configurable)
```

### Settings Storage Structure
```javascript
chrome.storage.local: {
  videoDuration: 10,               // seconds
  imageGenerationDelay: 60,        // seconds
  videoGenerationDelay: 90,        // seconds
  downloadDelay: 0,                // seconds
  // ... other settings
}
```

### Video Duration Selector Logic
```javascript
// WASM selectors required:
selectors.Gen5DurationBtn        // Button to open duration menu
selectors.Gen5DurationMenuItem   // Menu items selector

// Selection logic:
1. Click Gen5DurationBtn
2. Wait 300ms for menu
3. Find item with text matching "{duration}s" (e.g., "10s")
4. Click item
```

---

## ‚ö†Ô∏è ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

### Delay Settings ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:

**Image Generation Delay:**
- ‡∏†‡∏≤‡∏û‡∏õ‡∏Å‡∏ï‡∏¥: 30-60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‡∏†‡∏≤‡∏û‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô: 60-90 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ä‡πâ‡∏≤: 90-120 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

**Video Generation Delay:**
- 5s clips: 60-90 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- 10s clips: 90-120 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (default)
- 15s clips: 150-180 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

**Download Delay:**
- ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà: 0 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
- ‡πÄ‡∏ô‡πá‡∏ï‡∏ä‡πâ‡∏≤: 5-10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏°‡∏≤‡∏Å: 15-30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

### Troubleshooting:

**Error: ‡∏†‡∏≤‡∏û‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏£‡πá‡∏à**
‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏° `imageGenerationDelay`

**Error: ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏£‡πá‡∏à**
‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏° `videoGenerationDelay`

**Error: ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ**
‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏° `downloadDelay` (5-10s)

**Duration ‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏î‡πâ**
‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ WASM selectors ‡∏°‡∏µ `Gen5DurationBtn` ‡πÅ‡∏•‡∏∞ `Gen5DurationMenuItem`

---

## ‚úÖ Testing Checklist

- [x] Settings UI renders correctly
- [x] Default values load properly
- [x] Settings save to storage
- [x] Settings load from storage on reload
- [x] `getVideoDuration()` returns correct value
- [x] `getImageGenerationDelay()` returns correct value
- [x] `getVideoGenerationDelay()` returns correct value
- [x] `getDownloadDelay()` returns correct value
- [x] Automation uses new delays
- [x] Status messages show correct timing
- [ ] Video duration actually changes on Runway (requires testing on actual site)
- [ ] WASM selectors for Gen5Duration work correctly

---

## üéä ‡∏™‡∏£‡∏∏‡∏õ

‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:
1. ‚úÖ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏•‡∏¥‡∏õ (5/10/15s)
2. ‚úÖ Delay ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û (30-120s)
3. ‚úÖ Delay ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ (60-240s)
4. ‚úÖ Delay ‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î (0-30s)

‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á/‡πÄ‡∏ô‡πá‡∏ï ‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô error ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÑ‡∏î‡πâ!
